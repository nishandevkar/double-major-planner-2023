<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Result</title>
    <style>
        .unit-card {
            border: 1px solid #000;
            padding: 20px;
            margin: 20px;
            width: calc(25% - 40px);
            box-sizing: border-box;
            float: left;
        }

        .units-container::after {
            content: "";
            display: table;
            clear: both;
        }

        button {
            margin: 10px;
        }

        .selected {
            background-color: blue;
            color: white;
        }

        #prereqModal {
            display: none;
            position: fixed;
            z-index: 1;
            padding-top: 100px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.4);
        }

        #modalContent {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>

<!-- Prerequisites Modal -->
<div id="prereqModal">
    <div id="modalContent">
        <span class="close" onclick="document.getElementById('prereqModal').style.display='none'">&times;</span>
        <p id="prereqText"></p>
    </div>
</div>

<h2>Selected Majors:</h2>
<ul>
{% for major in majors %}
    <li><button class="filter-btn major-btn" onclick="filterUnits('major', '{{ major }}')">{{ major }}</button></li>
{% endfor %}
</ul>

<h2>Semesters:</h2>
<button class="filter-btn semester-btn" onclick="filterUnits('semester', 'sem1')">Semester 1</button>
<button class="filter-btn semester-btn" onclick="filterUnits('semester', 'sem2')">Semester 2</button>
<button class="filter-btn semester-btn" onclick="filterUnits('semester', 'all')">Show All</button>

<h2>Levels:</h2>
<button class="filter-btn level-btn" onclick="filterUnits('level', '1')">Level 1</button>
<button class="filter-btn level-btn" onclick="filterUnits('level', '2')">Level 2</button>
<button class="filter-btn level-btn" onclick="filterUnits('level', '3')">Level 3</button>
<button class="filter-btn level-btn" onclick="filterUnits('level', 'all')">Show All</button>

<div class="units-container">
    {% for semester, units in units.items() %}
        {% for unit in units %}
            <div class="unit-card" data-major="{{ unit[3] }}" data-sem1="{{ unit[6] }}" data-sem2="{{ unit[7] }}" data-level="{{ unit[2] }}">
                <h3>{{ unit[0] }} - {{ unit[1] }}</h3>
                <p>Level {{ unit[2] }}</p>
                <p>Major: {{ unit[3] }}</p>
                <p>{{ 'Optional Unit' if unit[5] == 0 else 'Core Unit' }} / 6 points</p>
                <p>{{ 'Sem 1' if unit[6] == 'true' else '' }} {{ 'Sem 2' if unit[7] == 'true' else '' }}</p>
                {% if unit[4] %}
                    <button class="btn btn-primary" onclick="showPrereqs('{{ unit[4] }}')">Prerequisites</button>
                {% endif %}
            </div>
        {% endfor %}
    {% endfor %}
</div>

<script>
var selectedMajor = 'all';
var selectedSemester = 'all';
var selectedLevel = 'all';

function filterUnits(filterType, value) {
    document.querySelectorAll('.filter-btn.' + filterType + '-btn').forEach(btn => btn.classList.remove('selected'));
    event.target.classList.add('selected');

    if (filterType === 'major') {
        selectedMajor = value;
    } else if (filterType === 'semester') {
        selectedSemester = value;
    } else if (filterType === 'level') {
        selectedLevel = value;
    }

    var units = document.querySelectorAll('.unit-card');
    units.forEach(function(unit) {
        var majorMatch = (unit.getAttribute('data-major') === selectedMajor || selectedMajor === 'all');
        var semMatch = (selectedSemester === 'all' || unit.getAttribute('data-' + selectedSemester) === 'true');
        var levelMatch = (unit.getAttribute('data-level') === selectedLevel || selectedLevel === 'all');

        if (majorMatch && semMatch && levelMatch) {
            unit.style.display = 'block';
        } else {
            unit.style.display = 'none';
        }
    });
}

function showPrereqs(prereqs) {
    document.getElementById('prereqText').innerText = prereqs || 'No prerequisites';
    document.getElementById('prereqModal').style.display = 'block';
}

var selectedMajor = 'all';
var selectedSemester = 'all';
var selectedLevel = 'all';

function filterUnits(filterType, value) {
    document.querySelectorAll('.filter-btn.' + filterType + '-btn').forEach(btn => btn.classList.remove('selected'));
    event.target.classList.add('selected');

    if (filterType === 'major') {
        selectedMajor = value;
    } else if (filterType === 'semester') {
        selectedSemester = value;
    } else if (filterType === 'level') {
        selectedLevel = value;
    }

    var units = document.querySelectorAll('.unit-card');
    units.forEach(function(unit) {
        var majorMatch = (unit.getAttribute('data-major') === selectedMajor || selectedMajor === 'all');
        var semMatch = (selectedSemester === 'all' || unit.getAttribute('data-' + selectedSemester) === 'true');
        var levelMatch = (unit.getAttribute('data-level') === selectedLevel || selectedLevel === 'all');

        if (majorMatch && semMatch && levelMatch) {
            unit.style.display = 'block';
        } else {
            unit.style.display = 'none';
        }
    });
}

function showPrereqs(prereqs) {
    document.getElementById('prereqText').innerText = prereqs || 'No prerequisites';
    document.getElementById('prereqModal').style.display = 'block';
}

</script>

</body>
</html>
