{% extends "base.html" %}

{% block content %}

<!-- selectCourse Page -->
<!-- Main Content -->
<div class="contents">
    <div class="card">
        <!-- Welcome Section -->
        <section class="intro">
            <h1>Welcome!</h1>
            <p>Choose the Course you are in </p>
        </section>

        <!-- Major Overview and Planner Section -->
        <section class="major-overview">
            <!-- The major overview content goes here -->
        </section>
            <!-- Course List Section -->
            <!-- <section class="courses">
                <h2>Courses</h2> -->
                <!-- Course Card Dropdown -->
                <div class="course-card-dropdown">
                    <button class="course-card-btn">Course List <i class="dropdown-icon">▼</i></button>
                    <div class="course-card-options">
                        {% for course in courses %}
                        <a href="#" class="course-option">{{course}}</a>
                        {% endfor %}
                        <!-- Add more options as needed -->
                    </div>
                </div>
            

        <!-- Sidebar or Additional Information -->
        <aside>
            <!-- The content from the sidebar in the screenshot goes here -->
        </aside>

        <!-- Confirmation Button -->
        <button class="confirm-btn" disabled>Confirm</button>
    </div>
</div>


<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // selectCourse Page
        // Select the course card button and the options
        const courseCardBtn = document.querySelector('.course-card-btn');
        const courseCardOptions = document.querySelector('.course-card-options');
        const courseOptions = document.querySelectorAll('.course-option');
        const confirmBtn = document.querySelector('.confirm-btn');
    
        // Event listener to toggle the dropdown
        courseCardBtn.addEventListener('click', function() {
            if (courseCardOptions.style.display === 'none' || courseCardOptions.style.display === '') {
                courseCardOptions.style.display = 'block';
            } else {
                courseCardOptions.style.display = 'none';
            }
        });
    
        // Close the dropdown when clicked outside
        document.addEventListener('click', function(event) {
            if (!courseCardBtn.contains(event.target)) {
                courseCardOptions.style.display = 'none';
            }
        });
    
        selectedCourse = ''
        // Update the button text when an option is selected
        courseOptions.forEach(function(option) {
            option.addEventListener('click', function() {
                courseCardBtn.innerHTML = `${option.textContent} <i class="dropdown-icon">▼</i>`;
                courseCardOptions.style.display = 'none'; // Hide the dropdown after selection
                confirmBtn.disabled = false; // Enable the confirm button
                selectedCourse = `${option.textContent}`
            });
        });
    
        // Redirect to selectMajor.html when the confirm button is clicked
        confirmBtn.addEventListener('click', function() {
            // Create a data object to send to the Flask backend with a POST request
            const data = { 'selected_course': selectedCourse };
    
            // Send an AJAX POST request to the Flask route
            fetch('/submit_course', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
            .then(response => response.json())
            .then(data => {
                console.log(data.message);
                const queryParams = new URLSearchParams();
                queryParams.set('majors', JSON.stringify(data.majors));
    
                // Redirect to selectMajor.html with query parameters
                window.location.href = `/selectMajor?${queryParams.toString()}`;
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    });
    
    
</script>
{% endblock %}
